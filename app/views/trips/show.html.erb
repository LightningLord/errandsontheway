<script type="text/javascript">
  var trip = <%= raw @trip.to_json.gsub('/', '\/') %>;
  var errands = <%= raw @trip.errands.to_json.gsub('/', '\/') %>;
  renderMap(trip, errands);
</script>


  <h1>Your trip</h1>
  <p><b>Start-point:</b> <%= @trip.start_point_address %><br>
  <b>Destination:</b> <%= @trip.end_point_address %></p>

  <h3>Trip Duration: <%= time_in_minutes(@trip_duration) %></h3>

  <div id="map-canvas"></div>
    <% if reached_max_errands? %>
    <ol class="maximum">
      <% @trip.errands.each do |errand| %>
        <li><%= errand.business_name %> - <%= errand.address %></li>
      <% end %>

    </ol>

  <p>You have reached the maximum amount of errands. Please finalize your route to see the route.</p>
<% else %>
  Type in an errand:
  <div class="errand_search">
    <%= form_tag('/options', method: 'get') do %>
    <ol class="inline-list">
      <li><%= text_field_tag :search, nil, :placeholder => 'e.g. Pick up laundry, buy coffee' %></li>
      <li><%= submit_tag('Search') %></li>
    </ol>

    <ol>
      <% @trip.errands.each do |errand| %>
        <li><%= errand.business_name %> - <%= errand.address %></li>
      <% end %>
    </ol>
    <p>You have added <%= @trip.errands.count %> out of 3 total errands to your trip. </p>
  <% end %>
  </div>
<% end %>


<%= button_to "Finalize Trip", action: "finalize" %>
<%= render "start_over_link" %>
<div id="directions-panel"></div>

